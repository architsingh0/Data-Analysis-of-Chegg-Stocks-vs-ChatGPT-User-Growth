---
title: "Project 1"
author: "Archit Singh, Sreeram Kondapalli"
output: pdf_document
date: "2023-10-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
```


## Introduction

- In our project we wish to analyze how the rise of AI tools like ChatGPT has impacted the education industry and the tech industry
as a whole, seeing how companies that embraced it fared versus companies that did not.  We intend to delve into various aspects 
of this transformation, examining the extent to which companies that have adopted AI technologies have fared compared to those 
that have not embraced these innovations.
- Our primary motivating question for this project is: "What is the impact of AI tools, such as ChatGPT, on the education industry 
and the tech sector, and how has this adoption influenced the competitive landscape and performance of companies?"

## Methods/ Datasets

There are many datasets needed to analyze this topic as a whole. We have datasets accross the range from datasets of companies' stocks
to datasets for ChatGPT user growth, as well as a student survey on how they feel about AI.

#### ChatGPT User Growth 

```{r}
# Read data from the CSV file
chatgpt_users <- read.csv("Number of ChatGPT users recorded over past months.csv")
head(chatgpt_users)
#Renaming for simplicity
chatgpt_users <- chatgpt_users %>%
  rename(TotalVisits = 'Number.of.ChatGPT.users.recorded.over.past.months')
chatgpt_users$Date <- as.Date(chatgpt_users$Date, format="%Y-%m-%d")
```
```{r}
label_format_millions <- function(x) {
  scales::number_format(scale = 1e-6, suffix = "m")(x)
}

ggplot(chatgpt_users, aes(x=Date, y=TotalVisits)) +
  geom_line(color = "blue", size = 1.2) +
  geom_point(color = "red", size = 3, shape = 19, alpha = 0.7) +
  labs(title="Number of ChatGPT Users Over Time",
       subtitle="Monthly data from Nov 2022 to Aug 2023",
       x="Date", y="Total Visits (in millions)") +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
  scale_y_continuous(labels = label_format_millions) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title = element_text(size = 14, face = "bold"),
    panel.grid.major = element_line(color = "gray80"),
    panel.grid.minor = element_blank()
  )
```
```{r}
# Load in data
chegg_stock_price <- read.csv("CHGG.csv")

# Ensure the Date column is a Date type
chegg_stock_price$Date <- as.Date(chegg_stock_price$Date, format="%Y-%m-%d")

# Filter the data
filtered_chegg_stock_price <- chegg_stock_price %>%
  filter(Date >= as.Date("2022-05-01") & Date <= as.Date("2022-11-01"))

# Enhanced graph
ggplot(data = filtered_chegg_stock_price, aes(x = Date, y = Close)) +
  geom_line(aes(color = "Stock Price"), size = 1.5) +
  geom_point(aes(color = "Stock Price"), size = 3) +
  scale_color_manual(name = "", values = c("Stock Price" = "blue")) +
  labs(title = "Chegg Stock Price 6 months before ChatGPT",
       x = "Month",
       y = "Closing Price ($)") +
  theme_minimal() +
  theme(
    panel.grid.major = element_line(color = "gray90", size = 0.5),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none"
  ) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y")

```

 
#### ChatGPT User growth VS Chegg stock
wzp
```{r}
chatgpt_users$Date <- as.Date(chatgpt_users$Date)
filtered_chegg_stock_price <- chegg_stock_price %>%
  filter(Date >= as.Date("2022-05-01") & Date <= as.Date("2023-08-01"))
label_format_millions <- function(x) {
  scales::number_format(scale = 1e-6, suffix = "m")(x)
}

# Set up a scale factor based on the max values of both datasets
scale_factor <- max(chatgpt_users$TotalVisits) / max(filtered_chegg_stock_price$Close)

# Begin the ggplot visualization
p <- ggplot() +

  # Plot ChatGPT User Growth with thicker line and color adjustments
  geom_line(data = chatgpt_users, 
            aes(x = Date, y = TotalVisits, color = "ChatGPT User Growth"), 
            size = 1.2, alpha = 0.8) +
  
  # Plot Chegg Stock Price with adjusted scale factor, thicker line, and color adjustments
  geom_line(data = filtered_chegg_stock_price, 
            aes(x = Date, y = Close * scale_factor, color = "Chegg Stock Price"), 
            size = 1.2, alpha = 0.8) +

  # Set primary y-axis for ChatGPT User Growth with label format and secondary y-axis for Chegg Stock Price
  scale_y_continuous(name = "ChatGPT User Growth", 
                     labels = label_format_millions, 
                     sec.axis = sec_axis(~./scale_factor, name = "Chegg Stock Price")) +

  # Define graph title, subtitle, and x-axis label
  labs(title = "Comparison: Chegg Stock Price vs ChatGPT User Growth", 
       subtitle = "Visual representation of growth trends over time", 
       x = "Date", 
       caption = "Data source: Chegg & OpenAI") +
  
  # Use a light grid theme for a professional look
  theme_light() +

  # Increase the title font size and style
  theme(plot.title = element_text(face = "bold", size = 16),
        plot.subtitle = element_text(face = "italic", size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.position = "bottom",
        legend.key.size = unit(1, "cm")) +

  # Manually set the colors for the two lines with a pleasant color palette
  scale_color_manual(values = c("Chegg Stock Price" = "#1f77b4", "ChatGPT User Growth" = "#ff7f0e"))

# Display the plot
print(p)
```

#### Students' Perspective on AI

hello

```{r}
students_survey_ai <- read.csv("Survey_AI.csv")

ggplot(students_survey_ai, aes(x = Q7.Utility_grade)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black") +
  labs(x = "Utility Grade", y = "Count", title = "Distribution of Utility Grade")

# Bar plot for Q11.Disadvantage_educational_process
students_survey_ai %>%
  count(Q11.Disadvantage_educational_process) %>%
  ggplot(aes(x = reorder(Q11.Disadvantage_educational_process, n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(x = "Disadvantage in Educational Process", y = "Count", title = "Frequency of Each Disadvantage") +
  coord_flip()
```

#### Stock of Companies That Released Public AI

The following are the companies that announced generative AI

```{r, echo=FALSE}
NVDA <- read.csv("NVDA.csv")

# Convert the 'Date' column to a Date object
NVDA$Date <- as.Date(NVDA$Date)

# Create a line plot using ggplot2 with a red line
ggplot(NVDA, aes(x = Date, y = Close)) +
  geom_line(color = "red") +
  labs(title = "NVIDIA Stock Price Over Time",
       x = "Date",
       y = "Close Price") +
  theme_minimal()
```

```{r, echo=FALSE}
MSFT <- read.csv("MSFT.csv")

# Convert the 'Date' column to a Date object
MSFT$Date <- as.Date(MSFT$Date)

# Create a line plot using ggplot2 with a red line
ggplot(MSFT, aes(x = Date, y = Close)) +
  geom_line(color = "red") +
  labs(title = "Microsoft Stock Price Over Time",
       x = "Date",
       y = "Close Price") +
  theme_minimal()
```

```{r, echo=FALSE}
GOOG <- read.csv("GOOGL.csv")

# Convert the 'Date' column to a Date object
GOOG$Date <- as.Date(GOOG$Date)

# Create a line plot using ggplot2 with a red line
ggplot(GOOG, aes(x = Date, y = Close)) +
  geom_line(color = "red") +
  labs(title = "Google Stock Price Over Time",
       x = "Date",
       y = "Close Price") +
  theme_minimal()
```

#### Salaries for AI and ML Specialists

#### ML Model (Companies that integrate AI)

## Results

## Conclusions

## Appendix