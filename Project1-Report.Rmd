---
title: "Project 1"
author: "Archit Singh, Sreeram Kondapalli"
output: 
  pdf_document: 
    toc: true
date: "2023-10-12"
---

\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
```

```{r, echo=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
```


# Introduction

- In our project we wish to analyze how the rise of AI tools like ChatGPT has impacted the education industry and the tech industry
as a whole, seeing how companies that embraced it fared versus companies that did not.  We intend to delve into various aspects 
of this transformation, examining the extent to which companies that have adopted AI technologies have fared compared to those 
that have not embraced these innovations.
- Our primary motivating question for this project is: "What is the impact of AI tools, such as ChatGPT, on the education industry 
and the tech sector, and how has this adoption influenced the competitive landscape and performance of companies?"

# Methods/ Datasets

There are many datasets needed to analyze this topic as a whole. We have datasets accross the range from datasets of companies' stocks
to datasets for ChatGPT user growth, as well as a student survey on how they feel about AI.

## Students' Perspective on AI

We begin with a dataset that surveyed 91 students on their feelings about AI. There were many questions asked in this survey such as 
how the students learn about AI and when they think of AI what do they feel. However the main questions we are focusing on that were
asked in this survey were the following:

  - Question 6: In which areas do you think AI would have a big impact? With their options being: Education, Medicine, Agriculture, Constructions, Marketing,Public administration, Art
  - Question 7: On a scale of 1 to 10, how useful do you think AI would be in the educational process? (1- not useful at all, 10-extremely useful)

Let us now focus on Question 6

```{r}
students_survey_ai <- read.csv("Survey_AI.csv")
# Bar plot for Q6
# Separate the responses to question 6
df_q6 <- students_survey_ai %>%
  select(Q6.Domains) %>%
  separate_rows(Q6.Domains, sep = ";") %>%
  mutate(Q6.Domains = str_to_lower(str_trim(Q6.Domains)))

# Count the frequency of each domain
df_q6_count <- df_q6 %>%
  group_by(Q6.Domains) %>%
  summarise(Count = n())

# Plot the data
ggplot(df_q6_count, aes(x = reorder(Q6.Domains, Count), y = Count)) +
  geom_bar(stat = "identity", fill = "steelblue", width = 0.7) +
  coord_flip() +
  theme_minimal(base_size = 15) +
  theme(
    axis.text.x = element_text(angle = 0, hjust = 1, vjust = 0.5, color = "black"),
    axis.text.y = element_text(color = "black"),
    axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
    plot.title = element_text(hjust = 0.5)
  ) +
  labs(
    x = "Count",
    y = "Industries",
    title = "Impact Of AI Across Different Industries",
  )
```

This bar plot shows us how the participants responded to the question, we see that Medicine is the most closely followed by education. We wanted to investigate education further
thus we are going to now see specifically how the participants felt about AI in education with question 7.

```{r}
# Bar plot for Q7
ggplot(students_survey_ai, aes(x = Q7.Utility_grade)) +
  geom_histogram(binwidth = 1, fill = "skyblue3", color = "black", alpha = 0.7) +
  scale_x_continuous(breaks = seq(1, 10, 1), limits = c(1, 10)) +
  scale_y_continuous(breaks = seq(0, max(table(students_survey_ai$Q7.Utility_grade))+1, 1)) +
  labs(
    x = "Rating (1-10)",
    y = "Count",
    title = "How Useful AI Would Be In The Educational Process",
    caption = "Source: Students Survey on AI in Education"
  ) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 12, color = "black"),
    axis.title = element_text(size = 14, face = "bold"),
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    plot.caption = element_text(hjust = 1, size = 8)
  )


# Bar plot for Q11.Disadvantage_educational_process
# students_survey_ai %>%
#   count(Q11.Disadvantage_educational_process) %>%
#   ggplot(aes(x = reorder(Q11.Disadvantage_educational_process, n), y = n)) +
#   geom_bar(stat = "identity", fill = "steelblue") +
#   labs(x = "Disadvantage in Educational Process", y = "Count", title = "Frequency of Each Disadvantage") +
#   coord_flip()
```

We can see that from this bar plot that most 10 was the most frequent number and it indicates that most students that participated in this survey believe that AI is going to be
super helpful in the education sector.

## Chegg Stock

The ethics of the matter aside before the release of AI tools, students turned to websites such as Chegg to help them in their school work. This is reflected in their stock
price, Chegg is only one of the homework help companies that is publically traded. We can see that Chegg stock was higher than ever right before the release of ChatGPT in November of 2022.

```{r}
# Load in data
chegg_stock_price <- read.csv("CHGG.csv")

# Ensure the Date column is a Date type
chegg_stock_price$Date <- as.Date(chegg_stock_price$Date, format="%Y-%m-%d")

# Filter the data
filtered_chegg_stock_price <- chegg_stock_price %>%
  filter(Date >= as.Date("2022-05-01") & Date <= as.Date("2022-11-01"))

# Enhanced graph
ggplot(data = filtered_chegg_stock_price, aes(x = Date, y = Close)) +
  geom_line(color = "blue", size = 1.5) +
  geom_point(color = "red", size = 3) +
  # scale_color_manual(name = "", values = c("Stock Price" = "blue")) +
  labs(title = "Chegg Stock Price 6 months before the release of ChatGPT",
       x = "Month",
       y = "Closing Price ($)") +
  theme_minimal() +
  theme(
    panel.grid.major = element_line(color = "gray90", size = 0.5),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none"
  ) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y")
```

## ChatGPT User Growth 

Something magical happened in November of 2022 as mentioned earlier. OpenAI which is a research lab focused on AI released their first public GPT model to the public being free to use.
We can see that ChatGPT user growth since it was release has been momentous. In fact, it is one of the fastest services to reach a million users as we will see. Let's see ChatGPT's user growth
plotted since its release.

```{r}
# Read data from the CSV file
chatgpt_users <- read.csv("Number of ChatGPT users recorded over past months.csv")
#Renaming for simplicity
chatgpt_users <- chatgpt_users %>%
  rename(TotalVisits = 'Number.of.ChatGPT.users.recorded.over.past.months')
chatgpt_users$Date <- as.Date(chatgpt_users$Date, format="%Y-%m-%d")

label_format_millions <- function(x) {
  scales::number_format(scale = 1e-6, suffix = "m")(x)
}

ggplot(chatgpt_users, aes(x=Date, y=TotalVisits)) +
  geom_point(color = "red", size = 3, shape = 19, alpha = 0.7) +
  geom_line(color = "blue", size = 1.2) +
  labs(title="Number of ChatGPT Users Over Time",
       subtitle="Monthly data from Nov 2022 to Aug 2023",
       x="Date", y="Total Visits (in millions)") +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
  scale_y_continuous(labels = label_format_millions) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title = element_text(size = 14, face = "bold"),
    panel.grid.major = element_line(color = "gray80"),
    panel.grid.minor = element_blank()
  )
```

This line plot shows us the amazing growth of ChatGPT and how it took the world by storm. In fact let us look at how long popular services took to reach 1 million users vs how long ChatGPT took.

```{r}
one_mil_users <- read.csv("time-taken-by-services-to-reach-1M.csv")
ggplot(one_mil_users, aes(x = reorder(Service, Days_to_reach_1M_users), y = Days_to_reach_1M_users)) +
  geom_bar(stat = "identity", fill = "#3498db", width = 0.7) +
  geom_text(aes(label = Days_to_reach_1M_users), position = position_dodge(0.5), hjust = -0.1, vjust = 0.5, color = "black", lineWidth = 4) +
  labs(
    title = "Days Taken by Services to Reach 1 Million Users",
    x = "Service",
    y = "Days to reach 1M users"
  ) +
  coord_flip() +
  ylim(0, max(one_mil_users$Days_to_reach_1M_users) + 100) +
  theme_light(base_size = 14) +
  theme(
    axis.title = element_text(face = "bold"),
    axis.text = element_text(color = "black"),
    plot.title = element_text(hjust = 1, size = 14, face = "bold")
  )
```
 
## ChatGPT User growth VS Chegg stock

Finally, here we analyze the impact that ChatGPT has had on the education industry as a whole with Chegg being a representation of the older education industry vs ChatGPT being the newer representation.

```{r}
chatgpt_users$Date <- as.Date(chatgpt_users$Date)
filtered_chegg_stock_price <- chegg_stock_price %>%
  filter(Date >= as.Date("2022-05-01") & Date <= as.Date("2023-08-01"))
label_format_millions <- function(x) {
  scales::number_format(scale = 1e-6, suffix = "m")(x)
}

# Set up a scale factor based on the max values of both datasets
scale_factor <- max(chatgpt_users$TotalVisits) / max(filtered_chegg_stock_price$Close)

# Begin the ggplot visualization
p <- ggplot() +

  # Plot ChatGPT User Growth with thicker line and color adjustments
  geom_line(data = chatgpt_users, 
            aes(x = Date, y = TotalVisits, color = "ChatGPT User Growth"), 
            size = 1.2, alpha = 0.8) +
  
  # Plot Chegg Stock Price with adjusted scale factor, thicker line, and color adjustments
  geom_line(data = filtered_chegg_stock_price, 
            aes(x = Date, y = Close * scale_factor, color = "Chegg Stock Price"), 
            size = 1.2, alpha = 0.8) +

  # Set primary y-axis for ChatGPT User Growth with label format and secondary y-axis for Chegg Stock Price
  scale_y_continuous(name = "ChatGPT User Growth", 
                     labels = label_format_millions, 
                     sec.axis = sec_axis(~./scale_factor, name = "Chegg Stock Price")) +

  # Define graph title, subtitle, and x-axis label
  labs(title = "Chegg Stock Price vs ChatGPT User Growth", 
       subtitle = "Visual representation of growth trends over time", 
       x = "Date", 
       caption = "Data source: Chegg & OpenAI") +
  
  # Use a light grid theme for a professional look
  theme_light() +

  # Increase the title font size and style
  theme(plot.title = element_text(face = "bold", size = 16),
        plot.subtitle = element_text(face = "italic", size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.position = "bottom",
        legend.key.size = unit(1, "cm")) +

  # Manually set the colors for the two lines with a pleasant color palette
  scale_color_manual(values = c("Chegg Stock Price" = "#1f77b4", "ChatGPT User Growth" = "#ff7f0e"))

# Display the plot
print(p)
```

In this graph we can see that Chegg's stock basically coincides dropping exactly with when ChatGPT releases and it has been on the downturn ever since then.
Whereas in contrast ChatGPT has been growing until recently until it has started plateauing.

## Stock of Companies That Released Public AI

On the topic of AI's growth we now change focus onto companies that have followed OpenAI's lead and released generative AI related products.
These companies show how profitable AI has been for them and how it can impact many industries and not just education.
The following are the companies that announced generative AI, beginning with Nvidia, Nvidia, if you are unaware makes graphical chips
that are great for running AI models for and they in turn sell these chips to other companies that want to create their own AI products.

```{r}
NVDA <- read.csv("NVDA.csv")

# Convert the 'Date' column to a Date object
NVDA$Date <- as.Date(NVDA$Date)

# Create a line plot using ggplot2 with a red line
ggplot(NVDA, aes(x = Date, y = Close)) +
  geom_line(color = "#E63946", size = 1) +
  geom_smooth(method = 'loess', se = FALSE, color = "blue", size = 1) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
  scale_y_continuous(labels = scales::dollar_format(scale = 1)) +
  labs(
    title = "NVIDIA Stock Price Over Time",
    subtitle = "Daily Closing Prices with LOESS Smoothing",
    x = "Date",
    y = "Close Price (USD)",
    caption = "Source: Stock Market Data"
  ) +
  theme_light(base_size = 12) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5),
    plot.caption = element_text(size = 8, hjust = 1)
  )
```

Next is Microsoft, and their big generative AI product has been Bing AI. Since the release of Bing AI, Microsoft's stock has never been higher.

```{r}
MSFT <- read.csv("MSFT.csv")

# Convert the 'Date' column to a Date object
MSFT$Date <- as.Date(MSFT$Date)

# Create a line plot using ggplot2 with a red line
ggplot(MSFT, aes(x = Date, y = Close)) +
  geom_line(color = "#0072B2", size = 1.2) +
  labs(
    title = "Microsoft Stock Price Over Time",
    subtitle = "Based on Close Price",
    x = "Date",
    y = "Close Price ($)"
  ) +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 14),
    axis.title = element_text(face = "bold", size = 14),
    panel.grid.major = element_line(linetype = "dashed", color = "grey90"),
    panel.grid.minor = element_blank()
  ) +
  scale_x_date(date_breaks = "3 months", date_labels = "%b %Y") 
```

Finally, we look at Google's stock as a bit of an outlier, in which Google released their Bard AI to much criticisim because of something that
the chatbot got wrong in promotional materials. 

```{r}
GOOG <- read.csv("GOOGL.csv")

# Convert the 'Date' column to a Date object
GOOG$Date <- as.Date(GOOG$Date)

# Create a line plot using ggplot2 with a red line
ggplot(GOOG, aes(x = Date, y = Close)) +
  geom_line(color = "#D32F2F", size = 1.2) + # Adjusted color and size for better visualization
  labs(
    title = "Google Stock Price Over Time",
    subtitle = "Based on Close Price", 
    x = "Date",
    y = "Close Price ($)"
  ) +
  theme_light(base_size = 14) + # Switched to theme_light for a cleaner look
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 14),
    axis.title = element_text(face = "bold", size = 14),
    panel.grid.major = element_line(linetype = "dashed", color = "grey90"),
    panel.grid.minor = element_blank()
  )
```

## Salaries for AI and ML Specialists



# Results

AI is good.

# Conclusions

AI is good.

# Appendix
```{r ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```